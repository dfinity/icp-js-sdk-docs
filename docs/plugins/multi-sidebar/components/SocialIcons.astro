---
import pluginConfig from 'virtual:starlight-multi-sidebar/config';
import { type StarlightConfig } from '@astrojs/starlight/types';
import { Icon } from '@astrojs/starlight/components';
import { getCurrentPathComponents } from '../path.ts';
import { getCurrentHeader } from '../config.ts';

const { projectPath } = getCurrentPathComponents(Astro.url.pathname);
const currentHeader = getCurrentHeader(pluginConfig, projectPath);

let links: NonNullable<StarlightConfig['social']> = [];

if (currentHeader) {
  links = [{
    href: `https://github.com/${currentHeader.githubRepo}`,
    icon: 'github',
    label: 'GitHub',
  }]
}
---

{
    links.length > 0 && (
        <>
            {links.map(({ label, href, icon }) => (
                <a {href} rel="me" class="sl-flex">
                    <span class="sr-only">{label}</span>
                    <Icon name={icon} />
                </a>
            ))}
        </>
    )
}

<style>
    @layer starlight.core {
        a {
            color: var(--sl-color-text-accent);
            padding: 0.5em;
            margin: -0.5em;
        }
        a:hover {
            opacity: 0.66;
        }
    }
</style>
