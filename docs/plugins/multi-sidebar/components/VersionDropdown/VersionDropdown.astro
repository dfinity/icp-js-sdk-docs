---
import { getCurrentPathComponents } from '../../path.ts';
import { VersionDropdown as VersionDropdownReact } from '../VersionDropdown/VersionDropdown.tsx';
import pluginConfig from "virtual:starlight-multi-sidebar/config";

const { projectPath, subPath } = getCurrentPathComponents(Astro.url.pathname);
const currentProject = pluginConfig.sidebars.find(
  (p) => p.basePath === projectPath,
);

const dropdownOptions = currentProject?.versions || [];
const initialSelectedValue = dropdownOptions.find(
  ({ path }) => path.toLowerCase() === (subPath || "").toLowerCase(),
) ?? dropdownOptions[0];
---

<VersionDropdownReact
  client:load
  dropdownOptions={dropdownOptions}
  initialSelectedValue={initialSelectedValue?.path || ""}
/>
